import{r as s,M as J,j as e}from"./index-UyDEpSKi.js";import{T as K,A as d}from"./ToastAutoHide-mD-74I2T.js";import{P as Q}from"./Page-DWSL0diS.js";import{C as V,E as v}from"./CommonTable-CihJZmSo.js";import"./jspdf.plugin.autotable-DmuIJyGd.js";import{D as w,a as T,b as I,c as S}from"./TableCell-B8HtnHjl.js";import{T as N,B as X}from"./Box-BLXI0_F0.js";import{B as g}from"./Button-CjDs8j-X.js";import{I as m}from"./Grow-41TwNg0m.js";import{C as Y}from"./Close-Di1FhIrO.js";import{G as r}from"./Grid-CfjZ72w2.js";import{T as f}from"./TextField-BGn-4xfW.js";import{C as Z}from"./Container-uQWJgnJV.js";import{A as $,D as E}from"./DeleteOutline-DAPNekcB.js";import{S as A}from"./Stack-CILUL872.js";import{D as k}from"./createSvgIcon-Cv_souYI.js";import"./ButtonBase-Bhi2RUyb.js";import"./Menu-9ysSaJL7.js";import"./MenuItem-B_SiXQ1x.js";import"./TablePagination-CBjQ43ZL.js";import"./Toolbar-D0r--W_a.js";import"./useThemeProps-D04-WiJJ.js";const ye=()=>{const{globalState:u}=s.useContext(J),[D,M]=s.useState(),x={id:"",nombre:"",direccion:"",telefono:"",correo_electronico:""},[z,L]=s.useState([]),[i,o]=s.useState(x),[W,_]=s.useState(!1),[b,h]=s.useState(!1),[B,n]=s.useState({ident:null,message:null,type:null}),[R,C]=s.useState(null),[O,q]=s.useState(!1),p=async()=>{const{data:t}=await d().get("/laboratorio");L(t)},F=[{field:"id",headerName:"ID",width:120},{field:"nombre",headerName:"Nombre",width:220},{field:"direccion",headerName:"Dirección",width:220},{field:"telefono",headerName:"Telefono",width:220},{field:"correo_electronico",headerName:"Correo",width:220},{field:"",headerName:"Acciones",width:200,renderCell:t=>e.jsx(A,{direction:"row",divider:e.jsx(k,{orientation:"vertical",flexItem:!0}),justifyContent:"center",alignItems:"center",spacing:2,children:D==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{size:"small",onClick:()=>{h(!0),o(t.row),a()},children:e.jsx(v,{})}),e.jsx(m,{size:"small",onClick:()=>{l(),C(t.id)},children:e.jsx(E,{})})]})})}],G=async()=>{try{const{data:t}=await d().post("eliminar_lab",{id:R});n({ident:new Date().getTime(),message:t.message,type:"success"}),l(),p()}catch({response:t}){n({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},a=()=>{_(t=>!t)},l=()=>{q(t=>!t)},j=({target:t})=>{const{name:c,value:y}=t;o({...i,[c]:c==="rol"?Number(y):y})},P=async()=>{try{const{data:t}=await d().post("/guardar_lab",i);a(),o(x),n({ident:new Date().getTime(),message:t.message,type:"success"}),p(),h(!1)}catch({response:t}){n({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},U=async()=>{try{const{data:t}=await d().post("/editar_lab",i);a(),o(x),n({ident:new Date().getTime(),message:t.message,type:"success"}),p()}catch({response:t}){n({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},H=async()=>{try{const t=await d().get("/roles");setRoles(t.data)}catch(t){console.error("Error fetching roles data:",t)}};return s.useEffect(()=>{H(),p()},[]),s.useEffect(()=>{u.auth&&u.auth.rol&&M(u.auth.rol)},[u]),e.jsxs(e.Fragment,{children:[e.jsxs(w,{maxWidth:"xs",open:O,onClose:l,children:[e.jsx(T,{children:"¿Desea eliminar este laboratorio?"}),e.jsx(I,{children:e.jsx(N,{variant:"body1",color:"textSecondary",children:"Esta acción es irreversible."})}),e.jsxs(S,{children:[e.jsx(g,{variant:"text",color:"primary",onClick:l,children:"Cancelar"}),e.jsx(g,{variant:"contained",color:"primary",onClick:G,children:"Aceptar"})]})]}),e.jsxs(w,{maxWidth:"xs",open:W,onClose:a,children:[e.jsxs(T,{children:[b?"Editar Laboratorio":"Crear Laboratorio",e.jsx(m,{"aria-label":"close",onClick:a,style:{position:"absolute",right:8,top:8},children:e.jsx(Y,{})})]}),e.jsx(I,{dividers:!0,children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(f,{margin:"normal",name:"nombre",value:i.nombre,onChange:j,variant:"outlined",size:"small",fullWidth:!0,label:"Nombre del laboratorio"})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(f,{margin:"normal",name:"direccion",value:i.direccion,onChange:j,variant:"outlined",size:"small",fullWidth:!0,label:"Dirección"})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(f,{margin:"normal",name:"telefono",value:i.telefono,onChange:j,variant:"outlined",size:"small",fullWidth:!0,label:"Telefono"})}),e.jsx(r,{item:!0,xs:12,children:e.jsx(f,{margin:"normal",name:"correo_electronico",value:i.correo_electronico,onChange:j,variant:"outlined",size:"small",fullWidth:!0,label:"Correo"})})]})}),e.jsx(S,{children:e.jsx(g,{variant:"contained",color:"primary",onClick:b?U:P,children:"Guardar"})})]}),e.jsxs(Q,{title:"Chapina | Laboratorios",children:[e.jsx(K,{message:B}),e.jsxs(Z,{maxWidth:"lg",children:[e.jsx(X,{sx:{pb:5},children:e.jsx(N,{variant:"h4",children:"Lista de laboratorios"})}),e.jsx(r,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"center",children:D==="ADMIN"&&e.jsx(r,{item:!0,children:e.jsx(g,{onClick:()=>{h(!1),a(),o(x)},startIcon:e.jsx($,{}),variant:"contained",color:"primary",children:"Nuevo"})})}),e.jsx(r,{container:!0,spacing:2,sx:{mt:2},children:e.jsx(r,{item:!0,xs:12,children:e.jsx(V,{data:z,columns:F.map(t=>t.field===""?{...t,renderCell:c=>e.jsx(A,{direction:"row",divider:e.jsx(k,{orientation:"vertical",flexItem:!0}),justifyContent:"center",alignItems:"center",spacing:2,children:D==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{size:"small",onClick:()=>{h(!0),o(c.row),a()},children:e.jsx(v,{})}),e.jsx(m,{size:"small",onClick:()=>{l(),C(c.id)},children:e.jsx(E,{})})]})})}:t)})})})]})]})]})};export{ye as default};
