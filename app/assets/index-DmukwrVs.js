import{r as n,M as P,j as r}from"./index-UyDEpSKi.js";import{T as y,A as w}from"./ToastAutoHide-mD-74I2T.js";import{P as D}from"./Page-DWSL0diS.js";import{C as I,a as s,E as b}from"./CommonTable-CihJZmSo.js";import"./jspdf.plugin.autotable-DmuIJyGd.js";import{C as A}from"./Container-uQWJgnJV.js";import{B as E,T as B}from"./Box-BLXI0_F0.js";import{G as d}from"./Grid-CfjZ72w2.js";import{B as M}from"./Button-CjDs8j-X.js";import{A as L,D as O}from"./DeleteOutline-DAPNekcB.js";import{S as R}from"./Stack-CILUL872.js";import{D as T}from"./createSvgIcon-Cv_souYI.js";import{I as x}from"./Grow-41TwNg0m.js";import"./ButtonBase-Bhi2RUyb.js";import"./Menu-9ysSaJL7.js";import"./TextField-BGn-4xfW.js";import"./MenuItem-B_SiXQ1x.js";import"./TablePagination-CBjQ43ZL.js";import"./TableCell-B8HtnHjl.js";import"./Toolbar-D0r--W_a.js";import"./useThemeProps-D04-WiJJ.js";const le=()=>{n.useContext(P);const[m,z]=n.useState(),f={id:"",rol:"",ver_usuarios:"",ver_ventas:"",ver_compras:"",ver_inventario:"",ver_notificaciones:"",view_home:"",ver_rol:"",ver_lab:"",ver_prov:"",ver_historial_compras:"",ver_historial_ventas:"",ver_tipod:"",ver_permisos:"",ver_cliente:""},[v,l]=n.useState([]),[C,j]=n.useState(!1),[g,U]=n.useState({ident:null,message:null,type:null}),S=async()=>{const{data:e}=await w().get("/permisos");l(e)},_=()=>{j(!C)},i=async(e,o,p)=>{const c=e.target.checked,u={1:"ver_usuarios",2:"ver_ventas",3:"ver_compras",4:"ver_inventario",5:"ver_notificaciones",6:"view_home",7:"ver_rol",8:"ver_lab",9:"ver_prov",10:"ver_historial_compras",11:"ver_historial_ventas",12:"ver_tipod",13:"ver_permisos",14:"ver_cliente"}[p],N=v.map(t=>t.id===o.id?{...t,[u]:c?"Sí":"No"}:t);l(N);try{const t={rolId:o.id,permisoId:p},h=c?"/guardar_permiso":"/eliminar_permiso",{data:a}=await w().post(h,t);console.log(a.message)}catch(t){console.error("Error al realizar la solicitud:",t),l(h=>h.map(a=>a.id===o.id?{...a,[u]:c?"No":"Sí"}:a))}},k=[{field:"id",headerName:"ID",width:120},{field:"rol",headerName:"ROL",width:220},{field:"ver_usuarios",headerName:"Permiso usuario",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_usuarios==="Sí",onChange:o=>i(o,e.row,1)})},{field:"ver_ventas",headerName:"Permiso ventas",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_ventas==="Sí",onChange:o=>i(o,e.row,2)})},{field:"ver_compras",headerName:"Permiso compras",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_compras==="Sí",onChange:o=>i(o,e.row,3)})},{field:"ver_inventario",headerName:"Permiso inventario",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_inventario==="Sí",onChange:o=>i(o,e.row,4)})},{field:"ver_notificaciones",headerName:"Permiso notificaciones",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_notificaciones==="Sí",onChange:o=>i(o,e.row,5)})},{field:"ver_rol",headerName:"Permiso roles",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_rol==="Sí",onChange:o=>i(o,e.row,7)})},{field:"ver_lab",headerName:"Permiso laboratorios",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_lab==="Sí",onChange:o=>i(o,e.row,8)})},{field:"ver_prov",headerName:"Permiso proveedores",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_prov==="Sí",onChange:o=>i(o,e.row,9)})},{field:"ver_historial_compras",headerName:"Permiso historial compras",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_historial_compras==="Sí",onChange:o=>i(o,e.row,10)})},{field:"ver_historial_ventas",headerName:"Permiso historial ventas",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_historial_ventas==="Sí",onChange:o=>i(o,e.row,11)})},{field:"ver_tipod",headerName:"Permiso tipo de documento",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_tipod==="Sí",onChange:o=>i(o,e.row,12)})},{field:"ver_permisos",headerName:"Permiso a permisos rol",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_permisos==="Sí",onChange:o=>i(o,e.row,13)})},{field:"ver_cliente",headerName:"Permiso cliente",width:220,renderCell:e=>r.jsx(s,{checked:e.row.ver_cliente==="Sí",onChange:o=>i(o,e.row,14)})},{field:"",headerName:"Acciones",width:200,renderCell:e=>r.jsx(R,{direction:"row",divider:r.jsx(T,{orientation:"vertical",flexItem:!0}),justifyContent:"center",alignItems:"center",spacing:2,children:m==="ADMIN"&&r.jsxs(r.Fragment,{children:[r.jsx(x,{size:"small",onClick:()=>{setIsEdit(!0),setBody(e.row),_()},children:r.jsx(b,{})}),r.jsx(x,{size:"small",onClick:()=>{handleDialogDelete(),setIdDelete(e.id)},children:r.jsx(O,{})})]})})}];return n.useEffect(()=>{S()},[]),r.jsx(r.Fragment,{children:r.jsxs(D,{title:"Chapina | Permisos",children:[r.jsx(y,{message:g}),r.jsxs(A,{maxWidth:"lg",children:[r.jsx(E,{sx:{pb:5},children:r.jsx(B,{variant:"h4",children:"Lista de permisos"})}),r.jsx(d,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"center",children:m==="ADMIN"&&r.jsx(d,{item:!0,children:r.jsx(M,{onClick:()=>{setIsEdit(!1),_(),setBody(f)},startIcon:r.jsx(L,{}),variant:"contained",color:"primary",children:"Nuevo"})})}),r.jsx(d,{container:!0,spacing:2,sx:{mt:2},children:r.jsx(d,{item:!0,xs:12,children:r.jsx(I,{data:v,columns:k})})})]})]})})};export{le as default};
