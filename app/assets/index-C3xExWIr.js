import{r as s,M as H,j as e}from"./index-UyDEpSKi.js";import{T as J,A as c}from"./ToastAutoHide-mD-74I2T.js";import{P as K}from"./Page-DWSL0diS.js";import{C as Q,E as C}from"./CommonTable-CihJZmSo.js";import"./jspdf.plugin.autotable-DmuIJyGd.js";import{D as w,a as v,b as T,c as b}from"./TableCell-B8HtnHjl.js";import{T as I,B as V}from"./Box-BLXI0_F0.js";import{B as g}from"./Button-CjDs8j-X.js";import{I as d}from"./Grow-41TwNg0m.js";import{C as X}from"./Close-Di1FhIrO.js";import{G as o}from"./Grid-CfjZ72w2.js";import{T as Y}from"./TextField-BGn-4xfW.js";import{C as Z}from"./Container-uQWJgnJV.js";import{A as $,D as S}from"./DeleteOutline-DAPNekcB.js";import{S as E}from"./Stack-CILUL872.js";import{D as A}from"./createSvgIcon-Cv_souYI.js";import"./ButtonBase-Bhi2RUyb.js";import"./Menu-9ysSaJL7.js";import"./MenuItem-B_SiXQ1x.js";import"./TablePagination-CBjQ43ZL.js";import"./Toolbar-D0r--W_a.js";import"./useThemeProps-D04-WiJJ.js";const we=()=>{const{globalState:m}=s.useContext(H),[j,k]=s.useState(),u={id:"",nombre_documento:""},[M,N]=s.useState([]),[p,n]=s.useState(u),[B,R]=s.useState(!1),[f,x]=s.useState(!1),[_,a]=s.useState({ident:null,message:null,type:null}),[z,D]=s.useState(null),[O,q]=s.useState(!1),h=async()=>{const{data:t}=await c().get("/documento_select");N(t)},F=[{field:"id",headerName:"ID",width:120},{field:"nombre_documento",headerName:"Descripción",width:220},{field:"",headerName:"Acciones",width:200,renderCell:t=>e.jsx(E,{direction:"row",divider:e.jsx(A,{orientation:"vertical",flexItem:!0}),justifyContent:"center",alignItems:"center",spacing:2,children:j==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"small",onClick:()=>{x(!0),n(t.row),i()},children:e.jsx(C,{})}),e.jsx(d,{size:"small",onClick:()=>{r(),D(t.id)},children:e.jsx(S,{})})]})})}],W=async()=>{try{const{data:t}=await c().post("/eliminar_documento",{id:z});a({ident:new Date().getTime(),message:t.message,type:"success"}),r(),h()}catch({response:t}){a({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},i=()=>{R(t=>!t)},r=()=>{q(t=>!t)},G=({target:t})=>{const{name:l,value:y}=t;n({...p,[l]:l==="rol"?Number(y):y})},L=async()=>{try{const{data:t}=await c().post("/guardar_documento",p);i(),n(u),a({ident:new Date().getTime(),message:t.message,type:"success"}),h(),x(!1)}catch({response:t}){a({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},P=async()=>{try{const{data:t}=await c().post("/editar_documento",p);i(),n(u),a({ident:new Date().getTime(),message:t.message,type:"success"}),h()}catch({response:t}){a({ident:new Date().getTime(),message:t.data.sqlMessage,type:"error"})}},U=async()=>{try{const t=await c().get("/roles");setRoles(t.data)}catch(t){console.error("Error fetching roles data:",t)}};return s.useEffect(()=>{U(),h()},[]),s.useEffect(()=>{m.auth&&m.auth.rol&&k(m.auth.rol)},[m]),e.jsxs(e.Fragment,{children:[e.jsxs(w,{maxWidth:"xs",open:O,onClose:r,children:[e.jsx(v,{children:"¿Desea eliminar este tipo de documento?"}),e.jsx(T,{children:e.jsx(I,{variant:"body1",color:"textSecondary",children:"Esta acción es irreversible."})}),e.jsxs(b,{children:[e.jsx(g,{variant:"text",color:"primary",onClick:r,children:"Cancelar"}),e.jsx(g,{variant:"contained",color:"primary",onClick:W,children:"Aceptar"})]})]}),e.jsxs(w,{maxWidth:"xs",open:B,onClose:i,children:[e.jsxs(v,{children:[f?"Editar rol":"Crear rol",e.jsx(d,{"aria-label":"close",onClick:i,style:{position:"absolute",right:8,top:8},children:e.jsx(X,{})})]}),e.jsx(T,{dividers:!0,children:e.jsx(o,{container:!0,spacing:2,children:e.jsx(o,{item:!0,xs:12,children:e.jsx(Y,{margin:"normal",name:"descripcion",value:p.descripcion,onChange:G,variant:"outlined",size:"small",fullWidth:!0,label:"Descripción"})})})}),e.jsx(b,{children:e.jsx(g,{variant:"contained",color:"primary",onClick:f?P:L,children:"Guardar"})})]}),e.jsxs(K,{title:"Chapina | Tipo de documento",children:[e.jsx(J,{message:_}),e.jsxs(Z,{maxWidth:"lg",children:[e.jsx(V,{sx:{pb:5},children:e.jsx(I,{variant:"h4",children:"Lista de tipo de documento"})}),e.jsx(o,{container:!0,spacing:2,justifyContent:"space-between",alignItems:"center",children:j==="ADMIN"&&e.jsx(o,{item:!0,children:e.jsx(g,{onClick:()=>{x(!1),i(),n(u)},startIcon:e.jsx($,{}),variant:"contained",color:"primary",children:"Nuevo"})})}),e.jsx(o,{container:!0,spacing:2,sx:{mt:2},children:e.jsx(o,{item:!0,xs:12,children:e.jsx(Q,{data:M,columns:F.map(t=>t.field===""?{...t,renderCell:l=>e.jsx(E,{direction:"row",divider:e.jsx(A,{orientation:"vertical",flexItem:!0}),justifyContent:"center",alignItems:"center",spacing:2,children:j==="ADMIN"&&e.jsxs(e.Fragment,{children:[e.jsx(d,{size:"small",onClick:()=>{x(!0),n(l.row),i()},children:e.jsx(C,{})}),e.jsx(d,{size:"small",onClick:()=>{r(),D(l.id)},children:e.jsx(S,{})})]})})}:t)})})})]})]})]})};export{we as default};
